#!/bin/sh

#. /home/engines/functions/params_to_env.sh\r\n#params_to_env\r\n . /home/engines/functions/checks.sh\r\n required_values=\"cron_job when title parent_engine container_type\"\r\ncheck_required_values\r\n\r\nif test  ${container_type} = app\r\n then\r\n \tcontainer_type=engine\r\nfi\r\n\r\nrm  /home/cron/entries/${parent_engine}/$title\r\n\r\nif test $action_type = \"web\"\r\nthen\r\n\tcmd=\"curl http://${parent_engine}.engines.internal:8000$cron_job  -o /tmp/out\"\r\nelif test $action_type = \"command\"\r\n then\r\n   cmd=\"curl -k https://172.17.0.1:2380/v0/cron/engine/${parent_engine}/$title/run\"\r\nelif test $action_type = \"schedule\"\r\n then\r\n   cmd=\"curl -k https://172.17.0.1:2380/v0/schedule/${container_type}/${parent_engine}/${cron_job}\"\r\nelif test $action_type = \"action\"\r\n then\r\n   cmd=\"curl -k https://172.17.0.1:2380/v0/schedule/${container_type}/${parent_engine}/$title/run\"\r\nfi\r\n\r\necho \"$when $cmd \" > /home/cron/entries/${parent_engine}/${title}\r\n\r\n/home/engines/scripts/engine/rebuild_crontab.sh\r\n\r\necho \"Success\"\r\nexit 0
